{
    "type": "Ext.app.Controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userClassName": "UserCredentialsController"
    },
    "designerId": "4fd5c999-6918-471c-87b8-96d68a98489a",
    "cn": [
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "homeTabCardPanel",
                "selector": "homeTabCardPanel"
            },
            "designerId": "c7f74e71-6a07-4d98-bcf6-cda16cfcf85d"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "landingCardPanel",
                "selector": "landingCardPanel",
                "xtype": null
            },
            "designerId": "233e39f7-6a7e-4339-9208-ddd40d4b4562"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onRegistrationCardPanelItemIdSignUpSuccess",
                "designer|params": [
                    "userObject"
                ],
                "implHandler": [
                    "this.populateUserInfo(userObject);\r",
                    "this.populateUserResources(userObject);\r",
                    "\r",
                    "var landingCardPanel = this.getLandingCardPanel();\r",
                    "var mainTabPanel = this.getMainTabPanel();\r",
                    "\r",
                    "landingCardPanel.animateActiveItem(mainTabPanel, { type: 'slide'});"
                ],
                "name": "signUpSuccess",
                "designer|targetType": null,
                "designer|controlQuery": "panel"
            },
            "designerId": "8adce83d-36f6-4f59-abca-36f11fd96f56"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "genericLoginForm",
                "selector": "genericLoginForm"
            },
            "designerId": "2aa12afe-5197-42b0-9750-51f570318354"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onLoginFormItemIdSignUpRequested",
                "designer|params": [
                    "formpanel"
                ],
                "implHandler": [
                    "\r",
                    "var landingCardPanel = this.getLandingCardPanel();\r",
                    "var registrationCardPanel = this.getRegistrationCardPanel();\r",
                    "registrationCardPanel.setActiveItem(0);\r",
                    "landingCardPanel.animateActiveItem(registrationCardPanel, { type: 'slide'});"
                ],
                "name": "signUpRequested",
                "designer|targetType": "loginmodule",
                "designer|controlQuery": "formpanel"
            },
            "designerId": "699af9c6-fef2-42c6-b8fa-53d927c27677"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "registrationCardPanel",
                "selector": "registrationCardPanel",
                "xtype": null
            },
            "designerId": "dba25738-b8d8-421d-ad07-e177e59d0fa0"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onLoginFormItemIdSignInSuccess",
                "designer|params": [
                    "userObject"
                ],
                "implHandler": [
                    "this.populateUserInfo(userObject);\r",
                    "this.populateUserResources(userObject);\r",
                    "\r",
                    "var landingCardPanel = this.getLandingCardPanel();\r",
                    "var mainTabPanel = this.getMainTabPanel();\r",
                    "var homeTabCardPanel = this.getHomeTabCardPanel();\r",
                    "mainTabPanel.setActiveItem(homeTabCardPanel);\r",
                    "landingCardPanel.animateActiveItem(mainTabPanel, { type: 'slide'});"
                ],
                "name": "signInSuccess",
                "designer|targetType": "loginmodule",
                "designer|controlQuery": "formpanel"
            },
            "designerId": "d183b68e-5397-4a6b-a457-4a86ec1f5942"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "populateUserInfo",
                "designer|params": [
                    "userObject"
                ],
                "implHandler": [
                    "var currentUser = Ext.create('MyApp.model.Tuser');\r",
                    "currentUser.set('id',userObject.id);\r",
                    "currentUser.set('firstName',userObject.firstName);\r",
                    "currentUser.set('lastName',userObject.lastName);\r",
                    "currentUser.set('userid',userObject.userid);\r",
                    "currentUser.set('version',userObject.version);\r",
                    "\r",
                    "var userid = userObject.userid;\r",
                    "var authHeaderValue = userObject.authHeaderValue;\r",
                    "\r",
                    "localStorage.setItem('userid',userid);\r",
                    "sessionStorage.setItem('userInfo', JSON.stringify(userObject));\r",
                    "\r",
                    "MyApp.app.currentUser = currentUser; // Here currentUser becomes global variable to be accessed using MyApp.app.currentUser\r",
                    "MyApp.app.currentUser.tempId = 0;\r",
                    ""
                ]
            },
            "designerId": "84829d2b-8cc7-4a07-bdad-40488cce1ed6"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "mainTabPanel",
                "selector": "mainTabPanel",
                "xtype": null
            },
            "designerId": "9523ecbe-e521-4cbb-a0e2-7e51e18ebf57"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "registrationPage1",
                "selector": "#registrationPage1"
            },
            "designerId": "76f5d3a3-0136-41ae-8295-23b87547bd18"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onTabpanelActiveItemChange",
                "implHandler": [
                    "if(value.xtype === 'scoretabcardpanel') {\r",
                    "\r",
                    "    var userObject = JSON.parse(sessionStorage.getItem('userInfo'));\r",
                    "    MyApp.model.Tuser.load(userObject.id, {\r",
                    "\r",
                    "        success : function(record, operation) { \r",
                    "\r",
                    "            MyApp.app.currentUser = record;\r",
                    "\r",
                    "        },\r",
                    "        failure : function(record, operation) { \r",
                    "            alert ('tuser read failed');\r",
                    "        }\r",
                    "\r",
                    "    });\r",
                    "\r",
                    "}"
                ],
                "name": "activeitemchange",
                "designer|targetType": "MainTabPanel",
                "designer|controlQuery": "tabpanel"
            },
            "designerId": "44c9d041-5c5a-4051-a179-f30418fab5f5"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "populateUserResources",
                "designer|params": [
                    "userObject"
                ],
                "implHandler": [
                    "var userid = userObject.userid;\r",
                    "var authHeaderValue = userObject.authHeaderValue;\r",
                    "\r",
                    "var host;\r",
                    "\r",
                    "if(window.location.host === '' || window.location.host === 'localhost'){  \r",
                    "    host = 'localhost:8080';    \r",
                    "}else{\r",
                    "    host = window.location.host;\r",
                    "}\r",
                    "\r",
                    "var d = new Date();\r",
                    "var curr_date = d.getDate();\r",
                    "var curr_month = d.getMonth() + 1; //Months are zero based\r",
                    "var curr_year = d.getFullYear();\r",
                    "var today = (curr_month  + \"/\" + curr_date + \"/\" + curr_year);\r",
                    "\r",
                    "//todaysTortletsStore\r",
                    "var todaysTortletsStore = Ext.getStore('todaysTortletsStore');\r",
                    "var proxy = todaysTortletsStore.getProxy();\r",
                    "proxy.setUrl('http://' + host + '/tortlets?find=ByUseridEqualsAndCreatedOnEqualsAndCompleted&userid=' +userid + '&createdOn=' + today);\r",
                    "var headers = proxy.getHeaders();\r",
                    "headers.Authorization = authHeaderValue;\r",
                    "todaysTortletsStore.load();\r",
                    "\r",
                    "//incompleteTortletsStore\r",
                    "var incompleteTortletsStore = Ext.getStore('incompleteTortletsStore');\r",
                    "proxy = incompleteTortletsStore.getProxy();\r",
                    "headers = proxy.getHeaders();\r",
                    "headers.Authorization = authHeaderValue;\r",
                    "proxy.setUrl('http://' + host + '/tortlets?find=ByUseridEqualsAndCompleted&userid=' +userid);\r",
                    "\r",
                    "//dreamsStore\r",
                    "var dreamsStore = Ext.getStore('dreamsStore');\r",
                    "proxy = dreamsStore.getProxy();\r",
                    "headers = proxy.getHeaders();\r",
                    "headers.Authorization = authHeaderValue;\r",
                    "proxy.setUrl('http://' + host + '/dreams?find=ByUseridEquals&userid=' +userid);\r",
                    "\r",
                    "dreamsStore.load();\r",
                    "\r",
                    "//tortoisesStore\r",
                    "var tortoisesStore = Ext.getStore('tortoisesStore');\r",
                    "proxy = tortoisesStore.getProxy();\r",
                    "headers = proxy.getHeaders();\r",
                    "headers.Authorization = authHeaderValue;\r",
                    "proxy.setUrl('http://' + host + '/tortoises?find=ByDreamAndUseridEquals&userid=' +userid);\r",
                    "\r",
                    "////////////////////////////////////////////////////\r",
                    "\r",
                    "var Tuser = Ext.ModelMgr.getModel('MyApp.model.Tuser');\r",
                    "proxy = Tuser.getProxy();\r",
                    "headers = proxy.getHeaders();\r",
                    "headers.Authorization = authHeaderValue;\r",
                    "proxy.setUrl('http://' + host + '/tusers');\r",
                    "\r",
                    "var Dream = Ext.ModelMgr.getModel('MyApp.model.Dream');\r",
                    "proxy = Dream.getProxy();\r",
                    "headers = proxy.getHeaders();\r",
                    "headers.Authorization = authHeaderValue;\r",
                    "proxy.setUrl('http://' + host + '/dreams');\r",
                    "\r",
                    "var Tortoise = Ext.ModelMgr.getModel('MyApp.model.Tortoise');\r",
                    "proxy = Tortoise.getProxy();\r",
                    "headers = proxy.getHeaders();\r",
                    "headers.Authorization = authHeaderValue;\r",
                    "proxy.setUrl('http://' + host + '/tortoises');\r",
                    "\r",
                    "var Tortlet = Ext.ModelMgr.getModel('MyApp.model.Tortlet');\r",
                    "proxy = Tortlet.getProxy();\r",
                    "headers = proxy.getHeaders();\r",
                    "headers.Authorization = authHeaderValue;\r",
                    "proxy.setUrl('http://' + host + '/tortlets');\r",
                    "\r",
                    "console.log('coming out populate user resources');"
                ]
            },
            "designerId": "64825e33-ee9d-430e-9ad0-805ab459b228"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "populateUserSettingsForm",
                "designer|params": [
                    "form"
                ],
                "implHandler": [
                    "registrationPage1 = form;\r",
                    "\r",
                    "var firstName = registrationPage1.down('#firstName');\r",
                    "var lastName = registrationPage1.down('#lastName');\r",
                    "var userEmail = registrationPage1.down('#userEmail');\r",
                    "\r",
                    "var userid = registrationPage1.down('#userid');\r",
                    "var password = registrationPage1.down('#password');\r",
                    "var readablePassword = registrationPage1.down('#readablePassword');\r",
                    "\r",
                    "var userObject =  JSON.parse(sessionStorage.getItem('userInfo'));\r",
                    "\r",
                    "registrationPage1.userObject = userObject; // Assigning userObject to \r",
                    "// registration page because will need things like current authValue\r",
                    "// while updating the user\r",
                    "\r",
                    "firstName.setValue(userObject.firstName);\r",
                    "lastName.setValue(userObject.lastName);\r",
                    "userEmail.setValue(userObject.userEmail);\r",
                    "\r",
                    "userid.setValue(userObject.userid);\r",
                    "password.setValue(userObject.plainPassword);\r",
                    "readablePassword.setValue(userObject.plainPassword);"
                ]
            },
            "designerId": "8fe315f8-f44d-46ea-85de-d455b3cebdf7"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onUserProfileButtonTap",
                "implHandler": [
                    "var landingCardPanel = this.getLandingCardPanel();\r",
                    "var registrationCardPanel = this.getRegistrationCardPanel();\r",
                    "var registrationPage1 = this.getRegistrationPage1();\r",
                    "registrationPage1.getScrollable().getScroller().scrollToTop();\r",
                    "\r",
                    "registrationCardPanel.setActiveItem(registrationPage1);\r",
                    "\r",
                    "var userObject = JSON.parse(sessionStorage.getItem('userInfo'));\r",
                    "MyApp.model.Tuser.load(userObject.id, {\r",
                    "\r",
                    "    success : function(record, operation) { \r",
                    "        MyApp.app.currentUser = record;\r",
                    "        MyApp.app.getController('MyApp.controller.UserCredentialsController').populateUserSettingsForm(registrationPage1);\r",
                    "        landingCardPanel.animateActiveItem(registrationCardPanel, { type: 'slide'});\r",
                    "\r",
                    "    },\r",
                    "    failure : function(record, operation) { \r",
                    "        Ext.Msg.alert('','Server error');\r",
                    "    }\r",
                    "\r",
                    "});\r",
                    ""
                ],
                "name": "tap",
                "designer|targetType": "Ext.Button",
                "designer|controlQuery": "button[name='userProfileButton']"
            },
            "designerId": "50401324-0880-4422-8f20-de4db310475f"
        },
        {
            "type": "fixedfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "launch",
                "implHandler": [
                    "console.log('usercredential controller launch');\r",
                    "/*\r",
                    "var lastUserId = localStorage.getItem('userid');\r",
                    "var userObject = JSON.parse(sessionStorage.getItem('userInfo'));\r",
                    "\r",
                    "if( userObject !== null ){\r",
                    "\r",
                    "this.populateUserResources(userObject);\r",
                    "Ext.create('MyApp.view.MainTabPanel', {fullscreen: true});\r",
                    "//Ext.Viewport.setActiveItem({xtype : 'mainTabPanel' });\r",
                    "}else {\r",
                    "var landingCardPanel = Ext.create('MyApp.view.LandingCardPanel', {fullscreen: true});\r",
                    "//Ext.Viewport.setActiveItem({xtype : 'landingCardPanel' });\r",
                    "var useridField = landingCardPanel.down('#userIdItemId');\r",
                    "useridField.setValue(lastUserId);\r",
                    "}\r",
                    "*/"
                ]
            },
            "designerId": "79f65fff-66f7-494a-bbdd-0a5eceb5baa3"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onRegistrationCardPanelItemIdSignOut",
                "designer|params": [
                    "panel"
                ],
                "implHandler": [
                    "\r",
                    "sessionStorage.setItem('userInfo', null);\r",
                    "var landingcardPanel = this.getLandingCardPanel();\r",
                    "landingcardPanel.setActiveItem(0);\r",
                    "var useridField = landingcardPanel.down('#userIdItemId');\r",
                    "useridField.setValue(lastUserId);\r",
                    ""
                ],
                "name": "signOut",
                "designer|targetType": "signupmodule",
                "designer|controlQuery": "panel"
            },
            "designerId": "d30ab123-6185-42e4-bef0-26c719572d19"
        }
    ]
}